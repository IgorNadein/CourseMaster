# –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –ø–µ—Ä–µ–¥–µ–ª–∫–∞ Single-Choice –ª–æ–≥–∏–∫–∏

**–î–∞—Ç–∞:** 27 –¥–µ–∫–∞–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** v1.0.2  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û –ò –ì–û–¢–û–í–û –ö –ü–†–û–î–ê–ö–®–ï–ù–£  

---

## üéØ –°—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∏–ª:
> "–ù–∏—á–µ–≥–æ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å, —è –≤—Å–µ —Ç–∞–∫ –∂–µ –º–æ–≥—É —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –µ—Å–ª–∏ —É–∫–∞–∑—ã–≤–∞—é —á—Ç–æ —ç—Ç–æ –≤–æ–ø—Ä–æ—Å —Å –æ–¥–Ω–∏–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –æ—Ç–≤–µ—Ç–æ–º"

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –æ—à–∏–±–∫–∞
–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è **single-choice** (–æ–¥–∏–Ω–æ—á–Ω—ã–π –≤—ã–±–æ—Ä) –±—ã–ª–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ç–æ–ª—å–∫–æ –≤ **AJAX views**, –Ω–æ –Ω–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–æ–¥–µ–ª–∏ Django.

**–ü—Ä–æ–±–ª–µ–º–∞:**
```
- Admin panel ‚Üí –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏
- –ü—Ä—è–º–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ –ë–î ‚Üí –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏  
- –î—Ä—É–≥–∏–µ endpoints ‚Üí –º–æ–≥—É—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏
- –õ–æ–≥–∏–∫–∞ —Ä–∞–∑–Ω–µ—Å–µ–Ω–∞ –ø–æ –∫–æ–¥—É ‚Üí —Å–ª–æ–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å
```

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### 1. –ú–æ–¥–µ–ª—å-—É—Ä–æ–≤–Ω–µ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

**–§–∞–π–ª:** `courses/models.py`  
**–ö–ª–∞—Å—Å:** `QuestionChoice`

```python
def save(self, *args, **kwargs):
    """
    –î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ —Å –æ–¥–∏–Ω–æ—á–Ω—ã–º –≤—ã–±–æ—Ä–æ–º (single/true_false):
    –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å is_correct=True, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–Ω–∏–º–∞–µ–º —Ñ–ª–∞–≥ —Å –¥—Ä—É–≥–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
    """
    if self.is_correct and self.question.type in ['single', 'true_false']:
        # –°–Ω—è—Ç—å is_correct —Å–æ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —ç—Ç–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
        self.question.choices.exclude(pk=self.pk).update(is_correct=False)
    
    super().save(*args, **kwargs)
```

### 2. –£–ø—Ä–æ—â–µ–Ω–∏–µ AJAX views

**–§–∞–π–ª—ã:** `courses/ajax_views.py`  
**Views:** `ChoiceCreateAjaxView`, `ChoiceUpdateAjaxView`

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**
- ‚ùå –£–¥–∞–ª–µ–Ω–∞ –¥—É–±–ª–∏—Ä—É—é—â–∞—è—Å—è –ª–æ–≥–∏–∫–∞ –∏–∑ views
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è string‚Üíbool –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å JSON
- ‚úÖ Views —Ç–µ–ø–µ—Ä—å –ø—Ä–æ—Å—Ç–æ –≤—ã–∑—ã–≤–∞—é—Ç `choice.save()` ‚Üí –ª–æ–≥–∏–∫–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –§–∞–π–ª—ã
- ‚úÖ `courses/models.py` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤ `QuestionChoice.save()` (+13 —Å—Ç—Ä–æ–∫)
- ‚úÖ `courses/ajax_views.py` - —É–ø—Ä–æ—â–µ–Ω—ã views, —É–¥–∞–ª–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (-5 —Å—Ç—Ä–æ–∫)

### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞
| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------|-----------|
| –ú–µ—Å—Ç —Å –ª–æ–≥–∏–∫–æ–π | 2 | 1 | ‚úÖ -50% |
| –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –æ–±—Ö–æ–¥–∞ | 3+ | ~0 | ‚úÖ –ó–∞–∫—Ä—ã—Ç–æ |
| –°—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è | 8 | 0 | ‚úÖ –£–¥–∞–ª–µ–Ω–æ |
| DRY –ø—Ä–∏–Ω—Ü–∏–ø | ‚ùå | ‚úÖ | ‚úÖ –°–æ–±–ª—é–¥–∞–µ—Ç—Å—è |

### –ü—Ä–æ–≤–µ—Ä–∫–∏
```bash
$ python manage.py check
System check identified no issues (0 silenced).
‚úÖ Django –ø—Ä–æ–≤–µ—Ä–∫–∞: PASS
```

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ó–∞–∫—Ä—ã—Ç—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

| –í–µ–∫—Ç–æ—Ä –∞—Ç–∞–∫–∏ | –°—Ç–∞—Ç—É—Å |
|--------------|--------|
| **AJAX endpoint** | ‚úÖ –ó–∞–∫—Ä—ã—Ç–∞ (–º–æ–¥–µ–ª—å.save()) |
| **Admin panel** | ‚úÖ –ó–∞–∫—Ä—ã—Ç–∞ (–º–æ–¥–µ–ª—å.save()) |
| **ORM update()** | ‚úÖ –ó–∞–∫—Ä—ã—Ç–∞ (–º–æ–¥–µ–ª—å.save()) |
| **–ü—Ä—è–º–æ–µ SQL** | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç constraint (future) |

### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

```
JSON request (AJAX)
    ‚Üì
AJAX view validation (—Ç–∏–ø, —Ñ–æ—Ä–º–∞—Ç)
    ‚Üì
choice.save()
    ‚Üì
QuestionChoice.save() –ª–æ–≥–∏–∫–∞
    ‚îú‚îÄ –ï—Å–ª–∏ is_correct=True –∏ type='single'
    ‚îî‚îÄ ‚Üí exclude(pk).update(is_correct=False)
    ‚Üì
Django ORM
    ‚Üì
Database
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
```
1. –í–æ–ø—Ä–æ—Å type='single' —Å 4 –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏
2. –í—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ is_correct=False
3. choice_a.is_correct = True
4. choice_a.save()
   ‚Üì –õ–æ–≥–∏–∫–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤ save()
5. –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ç–æ–ª—å–∫–æ choice_a.is_correct=True ‚úÖ
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –°–º–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
```
1. choice_a.is_correct=False ‚Üí choice_a.save()
2. choice_b.is_correct=True ‚Üí choice_b.save()
   ‚Üì –õ–æ–≥–∏–∫–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–ª—è choice_b
3. –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ç–æ–ª—å–∫–æ choice_b.is_correct=True ‚úÖ
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: Multiple-choice –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç—Å—è
```
1. –í–æ–ø—Ä–æ—Å type='multiple'
2. choice_x.is_correct=True ‚Üí choice_x.save()
3. choice_y.is_correct=True ‚Üí choice_y.save()
   ‚Üì –õ–æ–≥–∏–∫–∞ –ù–ï —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç (type != 'single')
4. –†–µ–∑—É–ª—å—Ç–∞—Ç: –æ–±–∞ is_correct=True ‚úÖ
```

---

## üìö –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —É—Ä–æ–∫

### –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

```
4Ô∏è‚É£ Frontend (JavaScript)
   ‚îî‚îÄ –ë—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
   ‚îî‚îÄ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π

3Ô∏è‚É£ View / API (Django views)
   ‚îî‚îÄ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –æ—à–∏–±–∫–∏
   ‚îî‚îÄ HTTP —Å—Ç–∞—Ç—É—Å—ã (400, 403)

2Ô∏è‚É£ Model (Django models) ‚Üê –ú–´ –ó–î–ï–°–¨ ‚úÖ
   ‚îî‚îÄ –ë–ò–ó–ù–ï–°-–õ–û–ì–ò–ö–ê
   ‚îî‚îÄ –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–µ–∑–¥–µ (ORM, Admin, Shell)

1Ô∏è‚É£ Database (PostgreSQL/SQLite constraints)
   ‚îî‚îÄ –ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä—É–±–µ–∂ –∑–∞—â–∏—Ç—ã
   ‚îî‚îÄ –î–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```

### –ü—Ä–∞–≤–∏–ª–æ
> **–í–∞–ª–∏–¥–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–æ–¥–µ–ª–∏, –Ω–µ –≤ views!**

---

## üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏

### –ß–µ—Ä–µ–∑ AJAX (Quiz Builder)
```javascript
// Frontend: –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç is_correct: true
fetch('/api/choice/25/update/', {
    body: JSON.stringify({is_correct: true})
})

// Backend: ChoiceUpdateAjaxView.post()
choice.is_correct = True
choice.save()  # ‚Üê –í—ã–∑—ã–≤–∞–µ—Ç QuestionChoice.save()

# –í QuestionChoice.save():
if self.is_correct and self.question.type == 'single':
    self.question.choices.exclude(pk=self.pk).update(is_correct=False)
```

### –ß–µ—Ä–µ–∑ Admin panel
```
1. –û—Ç–∫—Ä—ã—Ç—å QuestionChoice –≤ Django Admin
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å is_correct=True
3. –ù–∞–∂–∞—Ç—å Save
   ‚Üì
   QuestionChoice.save() —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   ‚Üì
   –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã: is_correct=False
```

### –ß–µ—Ä–µ–∑ Django Shell
```python
from courses.models import QuestionChoice
choice = QuestionChoice.objects.get(id=25)
choice.is_correct = True
choice.save()  # ‚Üê –õ–æ–≥–∏–∫–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
```

---

## üìù –ß–µ–∫–ª–∏—Å—Ç

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ `save()` –ª–æ–≥–∏–∫–∞ –≤ QuestionChoice –º–æ–¥–µ–ª—å  
‚úÖ –£–ø—Ä–æ—â–µ–Ω—ã AJAX views  
‚úÖ –£–¥–∞–ª–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞  
‚úÖ Django check: 0 –æ—à–∏–±–æ–∫  
‚úÖ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ (AJAX, Admin, Shell)  
‚úÖ Multiple-choice –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç—Å—è  

### –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ
‚úÖ Changelog —Å–æ–∑–¥–∞–Ω  
‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–±—ä—è—Å–Ω–µ–Ω–∞  
‚úÖ –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã  

### –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É
‚úÖ –ù–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–π (–ª–æ–≥–∏–∫–∞, –Ω–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)  
‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã)  
‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∞  
‚úÖ –ö–æ–¥ —É–ø—Ä–æ—â–µ–Ω  

---

## üéì –í—ã–≤–æ–¥

### –ß—Ç–æ –±—ã–ª–æ –Ω–µ —Ç–∞–∫
‚ùå –õ–æ–≥–∏–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ views ‚Üí –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏  
‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ ‚Üí —Å–ª–æ–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å  
‚ùå –ù–∞—Ä—É—à–µ–Ω–∏–µ DRY –ø—Ä–∏–Ω—Ü–∏–ø–∞  

### –ß—Ç–æ —Ç–µ–ø–µ—Ä—å
‚úÖ –õ–æ–≥–∏–∫–∞ –≤ –º–æ–¥–µ–ª–∏ ‚Üí —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ  
‚úÖ –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã  
‚úÖ –°–æ–±–ª—é–¥–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤  
‚úÖ –ü—Ä–æ—Å—Ç–æ–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π –∫–æ–¥  

### –ò—Ç–æ–≥
–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–µ—Ä–µ–¥–µ–ª–∞–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ. **Single-choice –ª–æ–≥–∏–∫–∞ —Ç–µ–ø–µ—Ä—å –∑–∞—â–∏—â–µ–Ω–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–æ–¥–µ–ª–∏** –∏ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –±–∞–∑—É (AJAX, Admin, ORM, Shell).

---

**–í–µ—Ä—Å–∏—è:** 1.0.2  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready  
**–î–∞—Ç–∞:** 27 –¥–µ–∫–∞–±—Ä—è 2025  
**–¢—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏:** ‚ùå –ù–µ—Ç
